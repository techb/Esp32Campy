<!doctype html>
<html>
	<head>
		<title>esp32 Flask App</title>
	</head>
	<style>
		img {
			width: 640px;
			height: 480px;
		}
	</style>
	<body>
		<h1>Esp32 Cam</h1>
		<img id="stream" src="" />
		<div id="test"></div>
	</body>

	<script>
		console.log("testing12");
		const img = document.getElementById('stream');
		const WS_URL = 'ws://127.0.0.1:5000';
		const ws = new WebSocket(WS_URL);
		let urlObject;
		ws.onopen = () => console.log(`Connected to ${WS_URL}`);
		ws.onmessage = message => {
			const arrayBuffer = message.data;
			if(urlObject){
				URL.revokeObjectURL(urlObject);
			}
			urlObject = URL.createObjectURL(new Blob([arrayBuffer]));
			img.src = urlObject;
		}

	</script>
</html>